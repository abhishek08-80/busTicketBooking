# config/gateway.config.yml

# http
http:
  port: 1000
  host: localhost
# apiEndpoints
apiEndpoints:
  bus:
    host: 'localhost'
    paths: "/bus/*"
    methods: ["GET", "POST", "PUT", "DELETE"]

  customer:
    host: 'localhost'
    paths: "/customer/*"
    methods: ["GET", "POST", "PUT", "DELETE"]

    employees:
    host: 'localhost'
    paths: "/employees/*"
    methods: ["GET", "POST", "PUT", "DELETE"]

    ticketBooking:
    host: 'localhost'
    paths: "/ticketBooking/*"
    methods: ["GET", "POST", "PUT", "DELETE"]

    
    feedback:
    host: 'localhost'
    paths: "/feedback/*"
    methods: ["GET", "POST", "PUT", "DELETE"]

# serviceEndpoints
serviceEndpoints:
  busService:
    url: "http://localhost:3003/"

  customerService:
    url: "http://localhost:3002/"

  employeesService:
    url: "http://localhost:3001/"

  ticketBookingService:
    url: "http://localhost:3004/"

  feedbackService:
    url: "http://localhost:3005/"


# policies
policies:
  - cors
  - log
  - jwt
  - proxy

# pipelines
pipelines:
  busPipeline:
    apiEndpoints:
      - bus
    policies:
      - cors:
          - action:
              origin: '*'
              methods: 'GET,PUT,PATCH,POST,DELETE'
      - log:
          - action: 
              message: ${req.method} ${req.originalUrl}
      - proxy:
          - action:
              serviceEndpoint: busService
              changeOrigin: true
  
  customerPipeline:
    apiEndpoints:
      - customer
    policies:
      - cors:
          - action:
              origin: '*'
              methods: 'GET,PUT,PATCH,POST,DELETE'
      # - jwt:
      #     - action:
      #         secretOrPublicKey: 'nodeTypescript'
      #         checkCredentialExistence: false
      - log:
          - action: 
              message: ${req.method} ${req.originalUrl}
      - proxy:
          - action:
              serviceEndpoint: customerService
              changeOrigin: true

    employeesPipeline:
    apiEndpoints:
      - employees
    policies:
      - cors:
          - action:
              origin: '*'
              methods: 'GET,PUT,PATCH,POST,DELETE'
      # - jwt:
      #     - action:
      #         secretOrPublicKey: 'nodeTypescript'
      #         checkCredentialExistence: false
      - log:
          - action: 
              message: ${req.method} ${req.originalUrl}
      - proxy:
          - action:
              serviceEndpoint: employeesService
              changeOrigin: true



    ticketBookingPipeline:
    apiEndpoints:
      - ticketBooking
    policies:
      - cors:
          - action:
              origin: '*'
              methods: 'GET,PUT,PATCH,POST,DELETE'
      - log:
          - action: 
              message: ${req.method} ${req.originalUrl}
      - proxy:
          - action:
              serviceEndpoint: TicketBookingService
              changeOrigin: true


    feedbackPipeline:
    apiEndpoints:
      - feedback
    policies:
      - cors:
          - action:
              origin: '*'
              methods: 'GET,PUT,PATCH,POST,DELETE'
      - log:
          - action: 
              message: ${req.method} ${req.originalUrl}
      - proxy:
          - action:
              serviceEndpoint: FeedbackService
              changeOrigin: true
